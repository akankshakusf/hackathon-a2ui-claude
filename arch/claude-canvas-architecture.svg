<svg width="780" height="980" viewBox="0 0 780 980" xmlns="http://www.w3.org/2000/svg" font-family="Arial, sans-serif">

  <defs>
    <marker id="arr" markerWidth="10" markerHeight="10" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L9,3 z" fill="#7c3aed"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="780" height="980" fill="#f8f9fc"/>

  <!-- HEADER -->
  <rect x="0" y="0" width="780" height="64" fill="#4c1d95"/>
  <text x="390" y="30" text-anchor="middle" fill="#ffffff" font-size="20" font-weight="bold" letter-spacing="3">CLAUDE CANVAS</text>
  <text x="390" y="52" text-anchor="middle" fill="#c4b5fd" font-size="11" letter-spacing="3">DETAILED SYSTEM ARCHITECTURE</text>

  <!-- USER -->
  <text x="390" y="100" text-anchor="middle" fill="#1e1b4b" font-size="14" font-weight="bold">User types prompt</text>
  <line x1="390" y1="108" x2="390" y2="130" stroke="#7c3aed" stroke-width="2" marker-end="url(#arr)"/>

  <!-- â”€â”€ BOX 1: NEXT.JS FRONTEND â”€â”€ -->
  <rect x="60" y="134" width="660" height="178" rx="10" fill="#ffffff" stroke="#0891b2" stroke-width="2"/>
  <rect x="60" y="134" width="660" height="8" rx="5" fill="#0891b2"/>
  <text x="390" y="162" text-anchor="middle" fill="#0891b2" font-size="14" font-weight="bold">Next.js 15 Frontend  (localhost:3000)</text>
  <line x1="80" y1="172" x2="700" y2="172" stroke="#e2e8f0" stroke-width="1.2"/>

  <text x="100" y="196" fill="#475569" font-size="12">â€¢  Blank canvas + prompt textarea</text>
  <text x="100" y="218" fill="#475569" font-size="12">â€¢  Version timeline strip</text>
  <text x="100" y="240" fill="#475569" font-size="12">â€¢  Version preview modal</text>
  <text x="100" y="262" fill="#475569" font-size="12">â€¢  Refine bar</text>
  <text x="100" y="284" fill="#475569" font-size="12">â€¢  A2UIRenderer (Lit web components)</text>

  <text x="390" y="302" text-anchor="middle" fill="#0891b2" font-size="11" font-style="italic">Calls â†’ /api/generate (Next.js route)</text>

  <!-- Arrow 1 -->
  <line x1="390" y1="312" x2="390" y2="342" stroke="#7c3aed" stroke-width="2" marker-end="url(#arr)"/>
  <rect x="210" y="318" width="360" height="22" rx="5" fill="#ede9fe" stroke="#7c3aed" stroke-width="1"/>
  <text x="390" y="333" text-anchor="middle" fill="#5b21b6" font-size="11" font-weight="bold">POST  { prompt, history }</text>

  <!-- â”€â”€ BOX 2: API ROUTE â”€â”€ -->
  <rect x="60" y="346" width="660" height="158" rx="10" fill="#ffffff" stroke="#d97706" stroke-width="2"/>
  <rect x="60" y="346" width="660" height="8" rx="5" fill="#d97706"/>
  <text x="390" y="374" text-anchor="middle" fill="#92400e" font-size="14" font-weight="bold">/api/generate  (Next.js API Route)</text>
  <line x1="80" y1="384" x2="700" y2="384" stroke="#e2e8f0" stroke-width="1.2"/>

  <text x="100" y="408" fill="#475569" font-size="12">â€¢  Wraps prompt + conversation history into A2A JSON-RPC 2.0 payload</text>
  <text x="100" y="430" fill="#475569" font-size="12">â€¢  Attaches A2UI extension URI</text>
  <text x="100" y="452" fill="#475569" font-size="12">â€¢  Passes history via message.metadata.conversationHistory</text>
  <text x="100" y="474" fill="#475569" font-size="12">â€¢  Parses A2UI JSON from response parts</text>

  <!-- Arrow 2 -->
  <line x1="390" y1="504" x2="390" y2="534" stroke="#7c3aed" stroke-width="2" marker-end="url(#arr)"/>
  <rect x="210" y="510" width="360" height="22" rx="5" fill="#ede9fe" stroke="#7c3aed" stroke-width="1"/>
  <text x="390" y="525" text-anchor="middle" fill="#5b21b6" font-size="11" font-weight="bold">JSON-RPC 2.0 POST  â†’  localhost:10002</text>

  <!-- â”€â”€ BOX 3: PYTHON AGENT â”€â”€ -->
  <rect x="60" y="538" width="660" height="208" rx="10" fill="#fff7ed" stroke="#be185d" stroke-width="2"/>
  <rect x="60" y="538" width="660" height="8" rx="5" fill="#be185d"/>
  <text x="390" y="566" text-anchor="middle" fill="#9d174d" font-size="14" font-weight="bold">Python A2A Agent  (localhost:10002)</text>
  <line x1="80" y1="576" x2="700" y2="576" stroke="#fce7f3" stroke-width="1.2"/>

  <text x="100" y="600" fill="#475569" font-size="12">â€¢  UIGeneratorExecutor (AgentExecutor)</text>
  <text x="100" y="622" fill="#475569" font-size="12">â€¢  Reads conversation history from message metadata</text>
  <text x="100" y="644" fill="#475569" font-size="12">â€¢  Calls Anthropic Claude  (claude-sonnet-4-5)</text>
  <text x="100" y="666" fill="#475569" font-size="12">â€¢  Validates response vs A2UI JSON schema</text>
  <text x="100" y="688" fill="#475569" font-size="12">â€¢  Auto-retries with targeted error feedback  (max 2x)</text>
  <text x="100" y="710" fill="#475569" font-size="12">â€¢  Returns A2UI JSON as DataPart(s)</text>

  <!-- Retry indicator -->
  <rect x="560" y="656" width="140" height="40" rx="6" fill="#fffbeb" stroke="#d97706" stroke-width="1.5"/>
  <text x="630" y="672" text-anchor="middle" fill="#92400e" font-size="10" font-weight="bold">â†º Auto-retry</text>
  <text x="630" y="688" text-anchor="middle" fill="#92400e" font-size="10">on schema failure</text>

  <!-- Arrow 3 -->
  <line x1="390" y1="746" x2="390" y2="776" stroke="#7c3aed" stroke-width="2" marker-end="url(#arr)"/>
  <rect x="210" y="752" width="360" height="22" rx="5" fill="#ede9fe" stroke="#7c3aed" stroke-width="1"/>
  <text x="390" y="767" text-anchor="middle" fill="#5b21b6" font-size="11" font-weight="bold">A2UI JSON messages  (3 parts)</text>

  <!-- â”€â”€ BOX 4: LIT WEB COMPONENTS â”€â”€ -->
  <rect x="60" y="780" width="660" height="138" rx="10" fill="#f0fdf4" stroke="#059669" stroke-width="2.5"/>
  <rect x="60" y="780" width="660" height="8" rx="5" fill="#059669"/>
  <text x="390" y="808" text-anchor="middle" fill="#064e3b" font-size="14" font-weight="bold">@a2ui/lit Web Components  (browser)</text>
  <line x1="80" y1="818" x2="700" y2="818" stroke="#d1fae5" stroke-width="1.2"/>

  <text x="100" y="842" fill="#475569" font-size="12">â€¢  A2uiMessageProcessor parses messages</text>
  <text x="100" y="864" fill="#475569" font-size="12">â€¢  a2ui-surface Custom Element renders component tree</text>
  <text x="100" y="886" fill="#475569" font-size="12">â€¢  Live interactive UI in the DOM</text>

  <!-- Live badge -->
  <rect x="580" y="848" width="120" height="32" rx="16" fill="#059669"/>
  <circle cx="600" cy="864" r="5" fill="#ffffff" opacity="0.9"/>
  <text x="640" y="869" text-anchor="middle" fill="#ffffff" font-size="12" font-weight="bold">ðŸŸ¢  LIVE</text>

  <!-- FOOTER -->
  <rect x="0" y="940" width="780" height="40" fill="#1e1b4b"/>
  <text x="390" y="958" text-anchor="middle" fill="#c4b5fd" font-size="10" font-weight="bold" letter-spacing="1">NO CODE NO PROBLEM Â· AI TINKERERS NYC 2026</text>
  <text x="390" y="974" text-anchor="middle" fill="#818cf8" font-size="9">Next.js 15  Â·  Python A2A  Â·  claude-sonnet-4-5  Â·  A2UI v0.8  Â·  Lit Web Components</text>

</svg>
